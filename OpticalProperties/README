

In this exercise you will calculate 
the optical properties (imaginary and 
real part of the dielectric function and
other derived quantities) using SIESTA
for two different structures of boron nitride:
c-BN and h-BN

We use an automatic DZP basis set of moderately
localized orbitals. The basic idea is that you 
become familiar with the different switches 
in the input that allow performing such calculation.

First, you need to tell SIESTA that you want 
to perform a calculation of optical properties.
Thus, you should set  
'OpticalCalculation' to true. 

In this case SIESTA will calculate the imaginary part of
the dielectric function and will dump it into 
the file 'System_label.EPSIMG' 

(NOTE: The pseudopotentials needed are in files
B.psf and N.psf in this directory. You will need
to copy them to the appropriate subdirectories
(or use links) before running Siesta)

1) K-SAMPLING AND BROADENING

For a solid you need to specified a k-space grid
to sample the different optical (i.e., vertical)
transitions along the Brillouin zone.
You do that using the block 'Optical.Mesh'
A related parameter is 'Optical.Broaden', which 
set the artificial broadening applied to every 
transition so the calculated quantities will 
appear as continuous function and not as a collection
of spikes. 

The effect of different k-space meshes 'nxnxn' and 
broadening 'a' is analyze for c-BN using the different
input inside the files c-BN.nxnxn.a

A reasonably good sampling and smooth curve seems to be
obtained with 10x10x10 and 0.3 eV.

While doing these tests you will repeat several
times the same calculation. Therefore, it is very 
convenient that you copy the density matrix (file system_name.DM)
from the first converged calculation to restart the new
calculations. 

2) NUMBER OF BANDS

Notice that all the previous calculations have been performed
using only 10 bands. This means that we have calculated the 
optical transition matrix elements only between the 10 lowest
bands (out of the 26 that we have for BN using a DZP basis).
The number of bands used in the calculation can be controlled 
using the parameter 'Optical.NumberOfBands'. If this input 
line does not appear or is set to a very large number, then 
all the bands will be used in the calculation. Although not
obvious in the present example, this will considerably increase
the time required for the computation in many cases while it does 
not substantially improve the description of the optical 
properties at lower energies. 

It is important to take into account that the transitions for very large
energies will not be reliable in most cases due to the limitations 
of the basis set: a large basis set, with large angular momenta, is 
necessary to describe electronic states at high energies. However, 
with SIESTA and a DZP basis set you will be typically able to obtain
a reasonable description of the optical properties of most materials 
below, say, ~10 eV and up to ~20 eV using more complete basis set 
that incorporate more excited orbitals (particularly, higher values of l).

The input in the file 'c-BN.10x10x10.0.3.allbands' uses all the bands. 
We will see that the differences between both calculations (10 bands 
versus 26 bands) is only noticiable for energies higher than 25 eV.
The difference is tiny. We can thus continue restricting our calculations
to the 10 lowest bands. It has to be notice, however, that the 
deviations from the fulfillment of the f-sum rule will be higher
the smaller is the number of bands. This is important for the accuracy 
of the Kramers-Kroning transform necessary to obtain the real part
of the dielectric function and, from this, other related 
quantities like the refraction index or the reflectance.
See the ./analysis/README' file for more details of the postprocessing
of the file 'System_label.EPSIMG' generated by SIESTA.

3) SCISSOR OPERATOR
Standard DFT methods usually lead to an underestimation of the band gap.
This effect can be removed from the optical properties by applying
an ad-hoc shift of the unoccupied bands as specified by 'Optical.Scissor'.
This approach is usually known as the 'scissor operator' and you can 
check its effect running the calculation in 'c-BN.10x10x10.0.3.scissor'.

4) LIGHT POLARIZATION
Up to this point, all the calculations have been performed for
linearly polarized light with a well defined direction of 
the electric field. This is defined using the input
'Optical.PolarizationType' and the input block 'Optical.Vector'.
The possible choices for 'Optical.PolarizationType' are 'polarized',
'unpolarized' and 'polycrystal'. For the 'unpolarized' option
the propagation direction of light is defined, but the different
directions of the electric field within the perpendicular plane are 
averaged. Using the 'polycrystal' option all possible directions are 
averaged.

Since c-BN is a cubic material, all these options should give the
same result. You can check this running the calculation in 
'c-BN.10x10x10.0.3.polycrystal' and comparing with previous results.

5) NON-ISOTROPIC MATERIAL
Finally, hexagonal boron nitride (h-BN) is not isotropic.
Since it is a layered material, its optical properties parallel to 
the BN planes and perpendicular to the BN plane will be substantially
different. Run the calculations in 'h-BN.inplane' and 'h-BN.outplane'
to check this.

6) OBTAIN THE OPTICAL PROPERTIES 
Finally in 'analysis' you can find the programs to obtain different 
optical quantities from the information in the 'System_label.EPSIMG' 
files.
   
  
   






